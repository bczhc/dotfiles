#!/usr/bin/env bash

# 检查 wf-recorder 是否正在运行
if pgrep -x "wf-recorder" > /dev/null; then
    # 如果在运行，发送 SIGINT 信号（模拟按下 Ctrl+C）
    pkill -SIGINT -x "wf-recorder"
    notify-send 'wf-recorder stopped' -t 2000
else
    # 如果没在运行，发送通知并执行同目录下的 wfstart
    notify-send 'wfstart' -t 1000
    
    # 获取当前脚本所在的目录，确保能找到 ./wfstart
    SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
    
    if [ -f "$SCRIPT_DIR/wfstart" ]; then
        # 后台运行 wfstart，避免阻塞脚本
        "$SCRIPT_DIR/wfstart" &
    else
        notify-send "Error: ./wfstart not found in $SCRIPT_DIR" -t 3000
    fi
fi
