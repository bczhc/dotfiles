#!/bin/env ruby

process = IO.popen 'x11-event-monitor'
pid = nil
process.each_line do |line|
  if /^KeyPress .* F$/.match? line
    pid = Process.spawn('xdotool', 'click', '--repeat', '999999', '--delay', '20', '1')
    puts pid
  end
  if /^KeyRelease .* F$/.match? line
    puts "Kill: #{pid}"
    Process.kill('TERM', pid)
    Process.wait(pid)
  end
end